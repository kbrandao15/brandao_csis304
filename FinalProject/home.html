<html>
   <head>
      <title>Welcome to DisneyLand</title>
      <script type="text/javascript">

     // The URL we'll pull data from
     var theURL = "https://disneyland.disney.go.com/media/flashComponents/maps/datafeeds/dlr/DLRMaps32.xml";
      /**
      * A simple callback function to display some results from an
      * Ajax call. Note that 'this' in the context of the function will
      * be an XMLHttpRequest object at runtime
      */
     function setUpCallBack()
     {

        // If the request was successfull, put the response into
        // an area on the web page
        if (this.readyState==4 && this.status==200)
        {
           // Creates a DOMParser and parses the response as XML and then grabs
           // some attributes (max/min temps, images, warnings) from the document
           parser = new DOMParser();
           xmlDoc=parser.parseFromString(this.responseText,"text/xml");
           
           // attributes/elements grabbed from the XML
           var park1 = "disneyland";  
           var park2 = "disneys-california-adventure";  
           var filter = "attraction";  
           var lands_d = [];  
           var lands_ca = [];  
          // var tomorrowland = []; var frontierland = []; var new-orleans-square = []; var main-street-usa = []; var mixkeys-toontown = []; 
          // var critter-country = [];  var hollywood-pictures-backlot
          // var lands_d = ["tomorrowland", "adventureland", "frontierland", "new-orleans-square", main-street-usa",fantasyland mickeys-toontown critter-country];  
          // var lands_ca = ["hollywood-pictures-backlot", "paradise-pier", "sunshine-plaza", "golden-state", a-bugs-land];  
           
           // get the nodeList of entities in the xml, then go through all of them, searching for specific children
           entities = xmlDoc.getElementsByTagName("entity");  
           for (var i = 0; i < entities.length; i++){ 
               var parts = [];  
               entity = entities[i].children;  
               for (var j = 0; j < entity.length; j++){
                  parts.push(entity[j].nodeName);  
                }
                     
               var i_map = parts.indexOf("map");  
               var i_land = parts.indexOf("land");  
               var i_type = parts.indexOf("filters");  
               var i_attraction = parts.indexOf("label");  
           if (i_map >=0 && i_land >=0 && i_type >= 0 && i_attraction >= 0){ 
               var map = entity[i_map].childNodes[0].nodeValue;  
               var land = entity[i_land].childNodes[0].nodeValue;  
               var type = entity[i_type].children[0].childNodes[0].nodeValue;  
               var attraction = entity[i_attraction].childNodes[0].nodeValue;  
              alert("map = "+map);  
              alert("land = "+land);  
              alert("type = "+type);  
              alert("attraction = "+attraction);  
              
                 
            
               // determines if the entity is an attraction
               if (type == "attraction"){

                  // determines if part of the disneyland or disneys-california-adventure map,
                  // adding it to a land's list.  
                  if (map == park1){
                    var i_dland = lands_d.indexOf(land+"list");  
                    if (i_dland < 0)
                    {
                        var newLand = [];  
                        lands_d.push(newLand);  
                        i_dland = lands_d.length - 1;  
                        lands_d[i_dland].name = land;  
                    }
                    alert ("pushed land = "+lands_ca[0].name);  
                    lands_d[i_dland].push(attraction);  

                  } else if (map == park2){
                       var i_caland = lands_ca.indexOf(land+"list");  
                      if (i_caland < 0)
                      {
                        var newLand = [];  
                        lands_ca.push(newLand);  
                        i_caland = lands_ca.length - 1;  
                        lands_ca[i_caland].name = land;  
                      }
                      alert ("pushed land = "+lands_ca[0].name);  
                      lands_ca[i_caland].push(attraction);  
                      alert ("pushed attraction = "+lands_ca[0][0]);  
                     
                  }

                }

               }
               
               // determines if part of the disneyland or disneys-california-adventure map
              // if (x >= 0){
                   
                  // alert("found an entity:"+ (entity[x].childNodes[0].nodeValue));  
                   
 
                                  
             //  }

           }
       }
     }

      /**
      * Generic function to make an asynchronous call to the given URL
      * and call the given function to process the results
      *
      * param url to retrieve
      * param callbackFunction to invoke when done retrieving
      */
     function makeAsynchRequest(url, setUpCallBack)
     {
         // code for IE7+, Firefox, Chrome, Opera, Safari
         if (window.XMLHttpRequest)
         {
            xmlhttp=new XMLHttpRequest();
         }
         else // code for IE6, IE5
         {
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
         }

         // Create an anonymous function as the "callback" function
         // to be executed when the request finishes
         xmlhttp.onreadystatechange=setUpCallBack;

         // Get the request, encoding the URL to ensure that any
         // parameters it includes do not confuse the proxy
         xmlhttp.open("GET","proxy.php?mode=native&url="+
               encodeURIComponent(url), true);
         xmlhttp.send();
     }

    </script>
  
 <body>Testing <div id = "demo"></div><script> makeAsynchRequest(theURL, setUpCallBack);  </script>
 </body>
</html>